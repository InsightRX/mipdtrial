<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function for creating sampling designs. — create_sampling_design • mipdtrial</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function for creating sampling designs. — create_sampling_design"><meta name="description" content="Sampling times can usually be pre-specified if the dosing schedule is fixed.
In that case a scheme can be specified with static timepoints e.g.
time = c(1, 7.5, 25, 31.5) for taking peak-trough samples at dose
1 and 4 for an 8-hour regimen.
However, when the dosing interval is adaptive, the peak and trough sampling
times cannot stay static and have to be adapted on-the-fly during
simulations. In that case, it is possible to use when to specify
sampling at peak, trough or dose concentrations. In that case, the
time is not allowed. If not exact peak and trough concentrations should be
sample, use the offset parameter to sample e.g. an hour post-peak, or
shortly before true troughs."><meta property="og:description" content="Sampling times can usually be pre-specified if the dosing schedule is fixed.
In that case a scheme can be specified with static timepoints e.g.
time = c(1, 7.5, 25, 31.5) for taking peak-trough samples at dose
1 and 4 for an 8-hour regimen.
However, when the dosing interval is adaptive, the peak and trough sampling
times cannot stay static and have to be adapted on-the-fly during
simulations. In that case, it is possible to use when to specify
sampling at peak, trough or dose concentrations. In that case, the
time is not allowed. If not exact peak and trough concentrations should be
sample, use the offset parameter to sample e.g. an hour post-peak, or
shortly before true troughs."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mipdtrial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/busulfan_mipd.html">Model misspecification, a busulfan case study</a></li>
    <li><a class="dropdown-item" href="../articles/pegasp_mipd.html">Custom initial dose nomogram, a PEG Asparaginase case study</a></li>
    <li><a class="dropdown-item" href="../articles/sample_timing_yaml.html">Effect of sample timing (YAML example)</a></li>
    <li><a class="dropdown-item" href="../articles/sample_timing.html">Effect of sample timing (R example)</a></li>
    <li><a class="dropdown-item" href="../articles/vancomycin_interval_adaptation.html">Dose and interval adaptation (vancomycin)</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Function for creating sampling designs.</h1>

      <div class="d-none name"><code>create_sampling_design.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sampling times can usually be pre-specified if the dosing schedule is fixed.
In that case a scheme can be specified with static timepoints e.g.
<code>time = c(1, 7.5, 25, 31.5)</code> for taking peak-trough samples at dose
1 and 4 for an 8-hour regimen.
However, when the dosing interval is adaptive, the peak and trough sampling
times cannot stay static and have to be adapted on-the-fly during
simulations. In that case, it is possible to use <code>when</code> to specify
sampling at <code>peak</code>, <code>trough</code> or <code>dose</code> concentrations. In that case, the
<code>time</code> is not allowed. If not exact peak and trough concentrations should be
sample, use the <code>offset</code> parameter to sample e.g. an hour post-peak, or
shortly before true troughs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_sampling_design</span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  when <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scatter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  at <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lloq <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  anchor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dose"</span>, <span class="st">"day"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>a vector of numeric values. If no <code>at</code> values are specified,
these will be used as the fixed sampling times in the simulated trial.
If <code>at</code> values are supplied, the sampling times  will be calculated
adaptively during the trial. The <code>at</code> determine which dose or day is
used as reference, and <code>time</code> will be relative to the specified <code>at</code> anchor.</p></dd>


<dt id="arg-when">when<a class="anchor" aria-label="anchor" href="#arg-when"></a></dt>
<dd><p>character vector of same length as <code>time</code> (or single
value) determining how to interpret the provided sampling <code>time</code>. If <code>NULL</code>
will use the dose time as offset (default). Other options are: <code>cmax</code> or
<code>peak</code>, which will use the end of infusion as the base for the <code>time</code>, or
<code>cmin</code> or <code>trough</code>, which will use the time of next dose as the offset, or
<code>middle</code> or <code>cmid</code> which will use the middle between the anchored dose and
the next, or <code>random</code> which takes a random time point between the anchored
dose and the next.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>offset from standardized PK moments specified in <code>when</code>, e.g.
<code>c(1, -1)</code> with <code>when = c("peak", "trough")</code> to sample 1 hour after peak and
1 hour before trough.</p></dd>


<dt id="arg-scatter">scatter<a class="anchor" aria-label="anchor" href="#arg-scatter"></a></dt>
<dd><p>optional random variation in time, specified as the standard
deviation, e.g. <code>scatter = 0.1</code> to allow for variation in sampling time with
an SD of 0.1 hours. Only relevant for sampling times, not for
regimen_update designs or target designs. Random variation does not protect
for peaks or troughs becoming sampled during infusion or in previous / next
dose. So value for <code>scatter</code> should be chosen appropriately and probably
used in conjunction with approriate <code>offset</code> values.</p></dd>


<dt id="arg-at">at<a class="anchor" aria-label="anchor" href="#arg-at"></a></dt>
<dd><p>numeric vector of the dose or day number to "anchor"
the sampling times to. Vector needs to be of same length as <code>time</code>.
If <code>anchor</code> is set to <code>day</code>, then the first dose in that day is used.
If later doses in the day are preferred, the anchor can also be specified
fractionally, e.g. <code>1.5</code> will use the time of the first dose in the
second half of the 1st day.</p></dd>


<dt id="arg-lloq">lloq<a class="anchor" aria-label="anchor" href="#arg-lloq"></a></dt>
<dd><p>lower limit of quantification for TDMs</p></dd>


<dt id="arg-anchor">anchor<a class="anchor" aria-label="anchor" href="#arg-anchor"></a></dt>
<dd><p>either <code>day</code> or <code>dose</code>. Single value required, i.e. anchor
types cannot be mixed.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># to sample at 1.5/8.5/23.5 hours</span></span></span>
<span class="r-in"><span><span class="fu">create_sampling_design</span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">11.5</span>, <span class="fl">23.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lloq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $scheme</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   base offset at anchor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 dose    1.5  1   dose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 dose   11.5  1   dose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 dose   23.5  1   dose</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to sample at the peak (end of infusion) and trough (start of</span></span></span>
<span class="r-in"><span><span class="co"># next dose) of each dose</span></span></span>
<span class="r-in"><span><span class="fu">create_sampling_design</span><span class="op">(</span></span></span>
<span class="r-in"><span>  when <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak"</span>, <span class="st">"trough"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lloq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $scheme</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     base offset at anchor scatter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   peak      0  1   dose       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 trough      0  1   dose       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to sample 30 min post-peak and 30-min pre-trough for the first dose</span></span></span>
<span class="r-in"><span><span class="fu">create_sampling_design</span><span class="op">(</span></span></span>
<span class="r-in"><span>  when <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak"</span>, <span class="st">"trough"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lloq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $scheme</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     base offset at anchor scatter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   peak    0.5  1   dose       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 trough   -0.5  1   dose       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same as above, but now for the first and third dose</span></span></span>
<span class="r-in"><span><span class="fu">create_sampling_design</span><span class="op">(</span></span></span>
<span class="r-in"><span>  when <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"peak"</span>, <span class="st">"trough"</span>, <span class="st">"peak"</span>, <span class="st">"trough"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  anchor <span class="op">=</span> <span class="st">"dose"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lloq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $scheme</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     base offset at anchor scatter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   peak    0.5  1   dose       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 trough   -0.5  1   dose       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   peak    0.5  3   dose       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 trough   -0.5  3   dose       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jasmine Hughes, Ron Keizer, InsightRX.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

