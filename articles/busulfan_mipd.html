<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Model misspecification, a busulfan case study • mipdtrial</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model misspecification, a busulfan case study">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mipdtrial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/busulfan_mipd.html">Model misspecification, a busulfan case study</a></li>
    <li><a class="dropdown-item" href="../articles/pegasp_mipd.html">Custom initial dose nomogram, a PEG Asparaginase case study</a></li>
    <li><a class="dropdown-item" href="../articles/sample_timing_yaml.html">Effect of sample timing (YAML example)</a></li>
    <li><a class="dropdown-item" href="../articles/sample_timing.html">Effect of sample timing (R example)</a></li>
    <li><a class="dropdown-item" href="../articles/vancomycin_interval_adaptation.html">Dose and interval adaptation (vancomycin)</a></li>
    <li><a class="dropdown-item" href="../articles/vancomycin_timevarying_targets.html">Time-varying exposure targets (vancomycin)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Model misspecification, a busulfan case study</h1>
            
      

      <div class="d-none name"><code>busulfan_mipd.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we will demonstrate the following tools:</p>
<ul>
<li>using {mipdtrial} to simulate a trial, with the trial design
specified using R code.</li>
<li>simulating patient PK and estimating patient PK with different
models, to assess the impact of model misspecification</li>
<li>using a weight-based initial dose</li>
</ul>
<p>To account for model misspecification, we will use one model to
simulate (McCune, 2014) and one model to estimate (Shukla, 2020). This
is a simplified version of a <a href="https://link.springer.com/article/10.1007/s10928-024-09915-w" class="external-link">published
study</a> in which we compared non-compartmental analysis (NCA) with MAP
Bayesian estimation for AUC-guided busulfan dosing.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mipdtrial</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"pkbusulfanmccune"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">PKPDsim</span><span class="fu">::</span><span class="fu"><a href="https://insightrx.github.io/PKPDsim/reference/install_default_literature_model.html" class="external-link">install_default_literature_model</a></span><span class="op">(</span><span class="st">"pk_busulfan_mccune"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">loadNamespace</a></span><span class="op">(</span><span class="st">"pkbusulfanmccune"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"pkbusulfanshukla"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">PKPDsim</span><span class="fu">::</span><span class="fu"><a href="https://insightrx.github.io/PKPDsim/reference/install_default_literature_model.html" class="external-link">install_default_literature_model</a></span><span class="op">(</span><span class="st">"pk_busulfan_shukla"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">loadNamespace</a></span><span class="op">(</span><span class="st">"pkbusulfanshukla"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># For data handling/plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="define-trial-design">1. Define trial design<a class="anchor" aria-label="anchor" href="#define-trial-design"></a>
</h2>
<p>In this simple trial, patients will be dosed once per day for four
days, with 4 levels collected per day, at 3.5, 4, 6 and 8 hours
post-dose. We will adjust doses 2, 3, and 4 to achieve a target
cumulative AUC of 90 by t = 192 hours.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tdm_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_sampling_design.html">create_sampling_design</a></span><span class="op">(</span></span>
<span>  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  anchor <span class="op">=</span> <span class="st">"dose"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">target_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_target_design.html">create_target_design</a></span><span class="op">(</span></span>
<span>  targettype <span class="op">=</span> <span class="st">"cum_auc"</span>, </span>
<span>  targetvalue <span class="op">=</span> <span class="fl">90</span> <span class="op">*</span> <span class="fl">1000</span>,       <span class="co"># unit conversion</span></span>
<span>  time <span class="op">=</span> <span class="fl">192</span></span>
<span><span class="op">)</span></span>
<span><span class="va">update_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_regimen_update_design.html">create_regimen_update_design</a></span><span class="op">(</span></span>
<span>  at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  anchor <span class="op">=</span> <span class="st">"dose"</span>,</span>
<span>  dose_optimization_method <span class="op">=</span> <span class="va">map_adjust_dose</span></span>
<span><span class="op">)</span></span>
<span><span class="va">initial_method</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_initial_regimen_design.html">create_initial_regimen_design</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="va">weight_based_starting_dose</span>,</span>
<span>  mgkg <span class="op">=</span> <span class="fl">3.2</span>,</span>
<span>  dosing_weight <span class="op">=</span> <span class="st">"Weight"</span>, <span class="co"># matches column in data set</span></span>
<span>  regimen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    interval <span class="op">=</span> <span class="fl">24</span>,</span>
<span>    n <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    t_inf <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"infusion"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sim_mod_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_model_design.html">create_model_design</a></span><span class="op">(</span>lib <span class="op">=</span> <span class="st">"pkbusulfanmccune"</span><span class="op">)</span></span>
<span><span class="va">est_mod_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_model_design.html">create_model_design</a></span><span class="op">(</span>lib <span class="op">=</span> <span class="st">"pkbusulfanshukla"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_trial_design.html">create_trial_design</a></span><span class="op">(</span></span>
<span>  sampling_design <span class="op">=</span> <span class="va">tdm_design</span>,</span>
<span>  target_design <span class="op">=</span> <span class="va">target_design</span>,</span>
<span>  regimen_update_design <span class="op">=</span> <span class="va">update_design</span>,</span>
<span>  initial_regimen_design <span class="op">=</span> <span class="va">initial_method</span>,</span>
<span>  sim_design <span class="op">=</span> <span class="va">sim_mod_design</span>, </span>
<span>  est_design <span class="op">=</span> <span class="va">est_mod_design</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-a-set-of-digital-patient-covariates">2. Create a set of digital patient covariates<a class="anchor" aria-label="anchor" href="#create-a-set-of-digital-patient-covariates"></a>
</h2>
<p>We will create an example data set of 10 individuals originally drawn
from the NHANES data set. This data set was created from survey data
collected by the US National Center for Health Statistics from a general
sampling of the US population, and is available in the NHANES R
package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  Gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  Age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">34L</span>, <span class="fl">4L</span>, <span class="fl">49L</span>, <span class="fl">9L</span>, <span class="fl">8L</span>, <span class="fl">45L</span>, <span class="fl">66L</span>, <span class="fl">58L</span>, <span class="fl">54L</span>, <span class="fl">10L</span><span class="op">)</span>,</span>
<span>  Weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">87.4</span>, <span class="fl">17</span>, <span class="fl">86.7</span>, <span class="fl">29.8</span>, <span class="fl">35.2</span>, <span class="fl">75.7</span>, <span class="fl">68</span>, <span class="fl">78.4</span>, <span class="fl">74.7</span>, <span class="fl">38.6</span><span class="op">)</span>,</span>
<span>  Height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">164.7</span>, <span class="fl">105.4</span>, <span class="fl">168.4</span>, <span class="fl">133</span>, <span class="fl">130.6</span>, <span class="fl">166.7</span>, <span class="fl">169.5</span>, <span class="fl">182</span>, <span class="fl">169.4</span>, <span class="fl">141.8</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The next step is to make sure we have all the covariates we need.
Busulfan has a known time-dependent relationship with clearance, and so
the McCune model takes a covariate that indicates at what time this
relationship should start (T_CL_EFF; useful for test doses that should
not impact busulfan clearance). We will set this to zero for all
patients. The Shukla model also takes conditioning regimen as a
covariate, since co-medication with Clofarabine and Fludarabine was
associated with a change in clearance (REGI). We will also set this to
zero for all patients.</p>
<p>Other models might require fat-free mass or other calculated
covariates. This would be a good time to do that sort of processing on
your data set!</p>
<p>You may also need to convert between units (height in m to cm, for
example.)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">T_CL_EFF</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">REGI</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<p>Here are the first few rows of our data set:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID Gender Age Weight Height T_CL_EFF REGI</span></span>
<span><span class="co">#&gt; 1  1      1  34   87.4  164.7        0    0</span></span>
<span><span class="co">#&gt; 2  2      1   4   17.0  105.4        0    0</span></span>
<span><span class="co">#&gt; 3  3      0  49   86.7  168.4        0    0</span></span>
<span><span class="co">#&gt; 4  4      1   9   29.8  133.0        0    0</span></span>
<span><span class="co">#&gt; 5  5      1   8   35.2  130.6        0    0</span></span>
<span><span class="co">#&gt; 6  6      0  45   75.7  166.7        0    0</span></span></code></pre></div>
<p>We also need to link the covariates in our data set to the covariates
expected in the model:</p>
<ul>
<li>
<p>To check which covariates are required for your models use
<code><a href="https://insightrx.github.io/PKPDsim/reference/get_model_info.html" class="external-link">PKPDsim::get_model_covariates()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">PKPDsim</span><span class="fu">::</span><span class="fu"><a href="https://insightrx.github.io/PKPDsim/reference/get_model_info.html" class="external-link">get_model_covariates</a></span><span class="op">(</span><span class="va">sim_mod_design</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>,</span>
<span>    <span class="fu">PKPDsim</span><span class="fu">::</span><span class="fu"><a href="https://insightrx.github.io/PKPDsim/reference/get_model_info.html" class="external-link">get_model_covariates</a></span><span class="op">(</span><span class="va">est_mod_design</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AGE"      "WT"       "HT"       "SEX"      "T_CL_EFF" "REGI"</span></span></code></pre></div>
</li>
<li>
<p>To check which covariates are in your data set use
<code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ID"       "Gender"   "Age"      "Weight"   "Height"   "T_CL_EFF" "REGI"</span></span></code></pre></div>
</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  AGE <span class="op">=</span> <span class="st">"Age"</span>, </span>
<span>  WT <span class="op">=</span> <span class="st">"Weight"</span>, </span>
<span>  HT <span class="op">=</span> <span class="st">"Height"</span>, </span>
<span>  SEX <span class="op">=</span> <span class="st">"Gender"</span>,</span>
<span>  T_CL_EFF <span class="op">=</span> <span class="st">"T_CL_EFF"</span>,</span>
<span>  REGI <span class="op">=</span> <span class="st">"REGI"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-a-trial">3. Simulate a trial!<a class="anchor" aria-label="anchor" href="#simulate-a-trial"></a>
</h2>
<p>Each patient will start at a dose of 3.2 mg/kg body weight. We will
then use <code><a href="../reference/dose_grid_search.html">mipdtrial::dose_grid_search</a></code> to optimize doses to
attain a target of 90 mg*h/L.</p>
<p>For inter-individual variability terms, we will use the
inter-individual variability described by our “true” model, since this
should reflect the “true” distribution in patient pharmacokinetics.
Later, we will estimate the individual PK parameters using our
estimation model and the measured TDMs we “collect”.</p>
<p>For residual error terms, we will use the residual error of our
“true” model, since this is supposed to reflect the “true” unexplained
error (assay error, etc.). This function creates a data frame of error
to add to each “true” simulated concentration to produced a measured
therapeutic drug monitoring sample.</p>
<p>Here are the first few rows of our simulation results:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">final_exposure</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id  auc_true auc_est tta target_index</span></span>
<span><span class="co">#&gt; 1  1  93148.57   90000  NA            1</span></span>
<span><span class="co">#&gt; 2  2 110043.02   90000  NA            1</span></span>
<span><span class="co">#&gt; 3  3  92196.50   90000  NA            1</span></span>
<span><span class="co">#&gt; 4  4 100731.06   90000  NA            1</span></span>
<span><span class="co">#&gt; 5  5  92462.25   90000  NA            1</span></span>
<span><span class="co">#&gt; 6  6  95373.36   90000  NA            1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyze-results">6. Analyze results<a class="anchor" aria-label="anchor" href="#analyze-results"></a>
</h2>
<p>How well did our patients get to target? It looks like we estimated
that target attainment would be very high (all patients have an AUC very
close to 90 mg*h/L), but “true” AUC was higher than that due to some
model misspecification!</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span><span class="op">$</span><span class="va">final_exposure</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">auc_true</span>, <span class="va">auc_est</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"auc_type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"auc"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">auc_type</span>, y <span class="op">=</span> <span class="va">auc</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">90</span>, color <span class="op">=</span> <span class="st">"navyblue"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="st">"Cumulative AUC (mg\u00B7h/L)"</span>,</span>
<span>      x <span class="op">=</span> <span class="st">"AUC type"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="busulfan_mipd_files/figure-html/unnamed-chunk-12-1.png" width="192"></p>
<p>Even with some model misspecification, target attainment (within 20%
of target AUC) was still high:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">target_attainment</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">final_exposure</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    ontarget <span class="op">=</span> <span class="fu"><a href="../reference/is_on_target.html">is_on_target</a></span><span class="op">(</span><span class="va">auc_true</span>, <span class="va">target_design</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>proportion_ontarget <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ontarget</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">proportion_ontarget</span><span class="op">)</span></span>
<span><span class="va">target_attainment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">target_attainment</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span></span></code></pre></div>
<p>Overall, 90% of patients had a “true” AUC of 90 mg*h/L.</p>
<p>For an in-depth analysis of how differences between these two models
impact target attainment, see <a href="https://link.springer.com/article/10.1007/s10928-024-09915-w" class="external-link">Hughes
et al., <em>J PKPD</em> (2024)</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jasmine Hughes, Ron Keizer, InsightRX.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
